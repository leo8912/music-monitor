# 100-Project Specification & Rules

## 项目介绍
后端项目：集成了 **多平台音乐监控、自动下载** 的全栈解决方案。功能包括自动追踪歌手动态、企业微信推送、网页端播放和收藏。

## 开发规则总览
- **OS**: Windows 系统环境。
- **流程**: 建议 -> 确认 -> 实施。
- **文档**: 计划必须以 md 格式放入文档中，开头备注时间。

## 版本控制
- **唯一真理**: `version.py` 是版本号唯一来源。
- **前端**: 必须通过 API 动态获取版本号，禁止硬编码。
- **配置**: `config.example.yaml` 必须随时保持最新。

## 核心业务逻辑
1.  **搜索歌手**:
    - 调用 qqmusic-api、pyncm 搜索列表。
    - 优先从本地数据库获取(如有)。

2.  **添加/刷新**:
    - 获取封面、专辑名、发布日期。
    - 匹配歌手名、歌曲名一致性。
    - 优先本地数据库。

3.  **补全数据**:
    - 补全歌手名、头像、歌词、发布日期。
    - 写入数据库。

4.  **播放逻辑**:
    - **优先本地**: 检查本地媒体库是否有匹配文件 -> 直接播放。
    - **在线下载**: 无匹配 -> 调用 gdstudio 搜索下载无损最高音质。
    - **匹配策略**: 按音乐源顺序搜索，匹配歌手/专辑名一致性并打分，完全一致停止搜索。如果不一致则继续。
    - **翻唱控制**: 确保不下载翻唱歌曲。

5.  **下载限制**:
    - GDStudio API 频率限制: 5分钟 50次。

## 目录结构规范
`app/services/` 需保持解耦。
`music_providers/` 下包含: `base.py`, `netease_provider.py`, `qqmusic_provider.py`, `aggregator.py`.

## 强制技能调用
进行代码修改时，**必须**参考 `music-monitor-dev` (音乐监控开发) 技能：
- 架构决策 -> `1. Project Architecture`
- 前端开发 -> `2. Frontend UI Standards`
- GDStudio -> `6. GDStudio API Reference`
